!function(){var e,t={34930:function(e,t,n){"use strict";var r=n(27378),a=n(31542),l=n(71791),o=n(93694),c=n(24942),i=n(35870),u=n(73450),s="GET_RECORDS_START",m="GET_RECORDS_SUCCESS",d="GET_RECORDS_FAILURE",p="GET_STAT_START",E="GET_STAT_SUCCESS",f="GET_STAT_FAILURE",v="CLEAR_RECORDS",g="ADD_EMPTY_MOVIE_RECORD",y="ADD_EMPTY_TVSERIES_RECORD",h="UPDATE_RECORD_START",Z="UPDATE_RECORD_SUCCESS",w="UPDATE_RECORD_FAILURE",b="DELETE_RECORD_START",C="DELETE_RECORD_SUCCESS",O="DELETE_RECORD_FAILURE",S="DELETE_EMPTY_RECORD",_="POPULATE_MOVIES_AUTOSUGGEST_START",k="POPULATE_MOVIES_AUTOSUGGEST_SUCCESS",I="POPULATE_MOVIES_AUTOSUGGEST_FAILURE",T="POPULATE_TV_AUTOSUGGEST_START",N="POPULATE_TV_AUTOSUGGEST_SUCCESS",R="POPULATE_TV_AUTOSUGGEST_FAILURE",x="ADD_RECORD_START",P="ADD_RECORD_SUCCESS",A="ADD_RECORD_FAILURE",D="ORDER_RECORDS_BY",j="AUTHENTICATION_CLEAR",L="AUTHENTICATION_START",U="AUTHENTICATION_SUCCESS",M="AUTHENTICATION_FAILURE",F="GET_USERS_START",V="GET_USERS_SUCCESS",B="GET_USERS_FAILURE",Y="CLEAR_USERS",G="UPDATE_USER_SUCCESS",H="UPDATE_USER_FAILURE";function K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{_id:"0",viewdate:null,posterpath:null,title:null,releaseYear:null,originalTitle:null,director:null,rating:null,type:e,isEmptyRecord:!0,userId:null,id:null,backdrop_path:null,genres:null,overview:null,production_countries:null,reViewed:!1,notFinished:!1,position:null}}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q,J={data:null,isLoading:!1,error:null},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return J;case L:return{data:null,isLoading:!0,error:null};case U:return{data:W(W({},t.payload),{},{years:t.payload.years.length>0?t.payload.years:[(new Date).getFullYear().toString()]}),isLoading:!1,error:null};case M:return{data:null,isLoading:!1,error:{message:t.payload.message}};case G:return{data:W(W({},e.data),t.payload),isLoading:!1,error:null};case H:return{data:W({},e.data),isLoading:!1,error:{message:t.payload.response.data.message}};default:return e}},Q=n(98784),X={data:null,isLoading:!1,error:null},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y:return X;case F:return{data:null,isLoading:!0,error:null};case V:return{data:t.payload,isLoading:!1,error:null};case B:return{data:null,isLoading:!1,error:{message:t.payload.response.data.message}};case G:for(var n=(0,Q.cloneDeep)(e.data),r=n.items,a=0;a<r.length;a++){var l=r[a];if(l._id===t.payload._id){l.favouriteMovies=t.payload.favouriteMovies;break}}return{data:n,isLoading:!1,error:null};default:return e}},te=n(86250);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.MOVIE="movie",e.TV_SERIES="tvseries"}(q||(q={}));var ae={data:null,isLoading:!1,error:null},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return re(re({},e),{},{data:[re(re({},K()),{},{type:q.MOVIE})].concat((0,te.Z)(e.data))});case y:return re(re({},e),{},{data:[re(re({},K()),{},{type:q.TV_SERIES})].concat((0,te.Z)(e.data))});case P:for(var n=[re(re({},t.payload),{},{viewdate:new Date(t.payload.viewdate)})],r=1;r<e.data.length;r++)n.push(e.data[r]);return{data:n,isLoading:!1,error:null};case A:return{data:re({},e.data),isLoading:!1,error:{status:t.payload.response.status,message:t.payload.response.data.message}};case D:return e;case h:return re(re({},e),{},{isLoading:!0});case Z:var a=e.data.map((function(e){return e._id===t.payload.data._id?re(re({},t.payload.data),{},{viewdate:new Date(t.payload.data.viewdate)}):e})).sort((function(e,t){return t.viewdate-e.viewdate}));return{isLoading:!1,data:a,error:null};case w:return{error:null,isLoading:!1,data:null};case b:return re(re({},e),{},{isLoading:!0});case C:var l=(0,Q.filter)(e.data,(function(e){return e._id!==t.payload}));return{isLoading:!1,data:l,error:null};case O:return{error:null,isLoading:!1,data:null};case S:return re(re({},e),{},{data:(0,Q.filter)(e.data,(function(e){return"0"!==e._id}))});case s:return re(re({},e),{},{isLoading:!0});case m:var o=(0,Q.map)(t.payload,(function(e){return re(re({},e),{},{viewdate:new Date(e.viewdate)})}));return{isLoading:!1,data:o,error:null};case d:return{error:t.payload,isLoading:!1,data:null};case v:return{data:null,isLoading:!1,error:null};default:return e}},oe=[],ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return e;case k:return t.payload.data.results;case I:case T:return e;case N:return t.payload.data.results;case R:return e;case P:return[];default:return e}};function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se={data:null,isLoading:!1,error:null};var me=(0,o.UY)({user:$,users:ee,records:le,emptyRecordTMDbItems:ce,stat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return ue(ue({},e),{},{isLoading:!0});case E:return{data:t.payload.data,isLoading:!1,error:null};case f:return{error:null,isLoading:!1,data:null};default:return e}}}),de=me,pe=(n(55319),n(58604),n(4289)),Ee=n(69635),fe=n(34837),ve=n(66855),ge=n(29603),ye=function(e){return r.createElement("svg",(0,ge.Z)({xmlns:"http://www.w3.org/2000/svg",width:"88",height:"88",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-film"},e),r.createElement("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.createElement("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.createElement("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.createElement("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.createElement("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.createElement("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.createElement("line",{x1:"17",y1:"17",x2:"22",y2:"17"}),r.createElement("line",{x1:"17",y1:"7",x2:"22",y2:"7"}))},he=function(e){return r.createElement("svg",(0,ge.Z)({xmlns:"http://www.w3.org/2000/svg",width:"88",height:"88",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-star"},e),r.createElement("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"}))},Ze=function(e){return r.createElement("svg",(0,ge.Z)({xmlns:"http://www.w3.org/2000/svg",width:"88",height:"88",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-pie-chart"},e),r.createElement("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),r.createElement("path",{d:"M22 12A10 10 0 0 0 12 2v10z"}))},we=function(){var e=(0,l.v9)((function(e){return e})).user,t=null==e?void 0:e.data;return r.createElement("div",{className:"main"},r.createElement("div",{className:"main-hero"},r.createElement("div",{className:"appname"},"tracked"),r.createElement("div",{className:"description"},"Журнал для учёт просмотренных фильмов и сериалов"),r.createElement("div",{className:"start-button"},t?r.createElement(fe.Z,{as:pe.rU,to:"/diary/".concat(e.data.userId),key:"diary"},"Мой журнал"):r.createElement(fe.Z,{as:pe.rU,to:"/login",key:"login"},"Начать"))),r.createElement("div",{className:"main-items"},r.createElement(ve.Z,{className:"items",columns:3,textAlign:"center"},r.createElement(ve.Z.Row,null,r.createElement(ve.Z.Column,null,r.createElement(ye,{className:"item-icon"}),r.createElement("div",{className:"item-title"},"Фильмы"),r.createElement("div",{className:"item-description"},"Отмечайте просмотренные фильмы и сериалы.")),r.createElement(ve.Z.Column,null,r.createElement(he,{className:"item-icon"}),r.createElement("div",{className:"item-title"},"Оценки"),r.createElement("div",{className:"item-description"},"Ставьте оценки.")),r.createElement(ve.Z.Column,null,r.createElement(Ze,{className:"item-icon"}),r.createElement("div",{className:"item-title"},"Статистика"),r.createElement("div",{className:"item-description"},"Просматривайте статистику ваших просмотров."))))))},be=n(41476),Ce=n(63697),Oe=n(57135),Se=n.n(Oe),_e=n(14206),ke=n.n(_e),Ie="37662c76ffc19e5cd1b95f37d77155fc",Te="https://api.themoviedb.org/3";function Ne(e){return ke().get("".concat(Te,"/movie/").concat(e,"/credits?api_key=").concat(Ie))}var Re="http://image.tmdb.org/t/p/w92",xe="TRACKED_USER_DATA",Pe=[q.MOVIE,q.TV_SERIES],Ae=(new Date).getFullYear(),De={sortBy:"-viewdate",year:Ae,types:Pe};function je(e){var t={userId:e};return ke().get("/api/user/profile",{params:t})}function Le(e){return ke().post("/api/record",e)}function Ue(e,t){return ke().put("/api/record/".concat(e),t)}function Me(e){return ke().put("/api/record/many",e)}function Fe(e){return ke().delete("/api/record/".concat(e))}function Ve(e,t){var n={userId:e};return t.sortBy&&(n.sortBy=t.sortBy),t.year&&(n.year=t.year),t.types&&(n.types=t.types),ke().get("/api/record",{params:n})}function Be(e,t){var n={userId:e,year:t};return ke().get("/api/stat",{params:n})}function Ye(e){var t=e.userId,n=e.limit,r=void 0===n?10:n,a=e.page,l={userId:t,limit:r,page:void 0===a?0:a};return ke().get("/api/user",{params:l})}function Ge(e){return ke().put("/api/user/profile",e)}ke().interceptors.request.use((function(e){var t=JSON.parse(localStorage.getItem(xe));return t&&(e.headers.Authorization="Bearer "+t.token),e}));var He=["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"];function Ke(){var e=new Date;return e.setHours(0,0,0,0),e}function ze(e,t,n){var r,a;return{userId:e,id:t.id,viewdate:Ke(),posterpath:t.poster_path,title:t.title,releaseYear:t.release_date.substring(0,4),originalTitle:t.original_title,rating:0,type:q.MOVIE,backdrop_path:t.backdrop_path,genres:t.genres,overview:t.overview,production_countries:(0,Q.map)(t.production_countries,(function(e){return e.iso_3166_1})),director:[null===(r=n.crew)||void 0===r||null===(a=r.find((function(e){return"Director"===e.job})))||void 0===a?void 0:a.name],reViewed:!1,notFinished:!1,cast:n.cast,crew:n.crew,position:"0"}}function We(e,t){return{userId:e,id:t.id,viewdate:Ke(),posterpath:t.poster_path,title:t.name,releaseYear:t.first_air_date.substring(0,4),originalTitle:t.original_name,rating:0,type:q.TV_SERIES,backdrop_path:t.backdrop_path,genres:t.genres,overview:t.overview,production_countries:t.origin_country,director:(0,Q.map)(t.created_by,(function(e){return e.name})),reViewed:!1,notFinished:!1,season:"1",inProduction:t.in_production,numberOfSeasons:t.number_of_seasons,position:"0"}}function qe(e){return function(t){return t({type:_}),function(e){return ke().get("".concat(Te,"/search/movie?api_key=").concat(Ie,"&language=ru-RU&query=").concat(e,"&page=1&include_adult=false"))}(e).then((function(e){return t({type:k,payload:e})}),(function(e){return t({type:I,payload:e})}))}}function Je(e){return function(t){return t({type:T}),function(e){return ke().get("".concat(Te,"/search/tv?api_key=").concat(Ie,"&language=ru-RU&query=").concat(e,"&page=1&include_adult=false"))}(e).then((function(e){return t({type:N,payload:e,meta:{debounce:{time:300,leading:!1}}})}),(function(e){return t({type:R,payload:e})}))}}function $e(e,t){return function(){var n=(0,be.Z)(Se().mark((function n(r){var a;return Se().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:h}),n.prev=1,n.next=4,Ue(e,t);case 4:return a=n.sent,r({type:Z,payload:a}),n.abrupt("return",a);case 9:throw n.prev=9,n.t0=n.catch(1),r({type:w,payload:n.t0}),n.t0;case 13:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e){return n.apply(this,arguments)}}()}function Qe(e,t){return function(){var n=(0,be.Z)(Se().mark((function n(r){var a,l,o,c,i,u;return Se().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:s}),n.prev=1,n.next=4,Ve(e,t);case 4:a=n.sent,r({type:m,payload:a.data}),n.next=15;break;case 8:n.prev=8,n.t0=n.catch(1),c=n.t0.response,i=null!==(l=null==c?void 0:c.data.message)&&void 0!==l?l:n.t0.message,u=null!==(o=null==c?void 0:c.status)&&void 0!==o?o:n.t0.status,r({type:d,payload:{message:i,status:u}});case 15:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e){return n.apply(this,arguments)}}()}function Xe(e){var t=e.email,n=e.password;return function(){var e=(0,be.Z)(Se().mark((function e(r){var a,l,o,c,i,u;return Se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:L}),e.prev=1,e.next=4,s={email:t,password:n},ke().post("/api/user/login",s);case 4:return a=e.sent,r({type:U,payload:a.data}),localStorage.setItem(xe,JSON.stringify({userId:a.data.userId,token:a.data.token})),e.abrupt("return",a);case 10:e.prev=10,e.t0=e.catch(1),c=e.t0.response,i=null!==(l=null==c?void 0:c.data.message)&&void 0!==l?l:e.t0.message,u=null!==(o=null==c?void 0:c.status)&&void 0!==o?o:e.t0.status,r({type:M,payload:{message:i,status:u}});case 17:case"end":return e.stop()}var s}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()}function et(e){var t=e.email,n=e.password,r=e.username;return function(){var e=(0,be.Z)(Se().mark((function e(a){var l,o,c,i,u,s;return Se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:L}),e.prev=1,e.next=4,m={email:t,password:n,username:r},ke().post("/api/user",m);case 4:return l=e.sent,a({type:U,payload:l.data}),localStorage.setItem(xe,JSON.stringify({userId:l.data.userId,token:l.data.token})),e.abrupt("return",l);case 10:e.prev=10,e.t0=e.catch(1),i=e.t0.response,u=null!==(o=null==i?void 0:i.data.message)&&void 0!==o?o:e.t0.message,s=null!==(c=null==i?void 0:i.status)&&void 0!==c?c:e.t0.status,a({type:M,payload:{message:u,status:s}});case 17:case"end":return e.stop()}var m}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()}function tt(e){var t=e.userId,n=e.page;return function(){var e=(0,be.Z)(Se().mark((function e(r){var a;return Se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:F}),e.prev=1,e.next=4,Ye({userId:t,page:n});case 4:return a=e.sent,r({type:V,payload:a.data}),e.abrupt("return",a);case 9:throw e.prev=9,e.t0=e.catch(1),r({type:B,payload:e.t0}),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()}function nt(e){return function(){var t=(0,be.Z)(Se().mark((function t(n){var r;return Se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:"UPDATE_USER_START"}),t.prev=1,t.next=4,Ge(e);case 4:return r=t.sent,n({type:G,payload:r.data}),t.abrupt("return",r);case 9:throw t.prev=9,t.t0=t.catch(1),n({type:H,payload:t.t0}),t.t0;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}var rt=function(e){var t=(0,r.useState)(e),n=(0,Ce.Z)(t,2),a=n[0],l=n[1];return[a,function(){return l(!a)}]},at=n(77891),lt=n(44277),ot=n(21527),ct=n(60059);function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var st=function(){var e,t,n,a,o,c=(0,Ee.k6)(),i=null===(e=(0,Ee.TH)().state)||void 0===e?void 0:e.prevLocation,s=(0,r.useState)({email:"",password:"",username:""}),m=(0,Ce.Z)(s,2),d=m[0],p=m[1],E=rt(!0),f=(0,Ce.Z)(E,2),v=f[0],g=f[1],y=(0,l.I0)(),h=(0,l.v9)((function(e){return e})).user;v?(t="Войти в свой аккаунт",n="Войти",a="Нет аккаунта?",o="Регистрация"):(t="Регистрация",n="Создать аккаунт",a="Есть аккаунт?",o="Войти");var Z,w=function(e){p(ut(ut({},d),{},(0,u.Z)({},e.target.name,e.target.value)))},b=function(){var e=(0,be.Z)(Se().mark((function e(){return Se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(v?Xe(d):et(d));case 2:e.sent&&c.push(i||"/");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.createElement(ve.Z,{className:"login",textAlign:"center"},r.createElement(ve.Z.Column,{style:{maxWidth:450}},r.createElement(lt.Z,{size:"large"},t),r.createElement(ot.Z,{size:"large"},r.createElement(ct.Z,null,r.createElement(ot.Z.Input,{fluid:!0,icon:"at",iconPosition:"left",placeholder:"E-mail",value:d.email,name:"email",onChange:w}),r.createElement(ot.Z.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Пароль",type:"password",value:d.password,name:"password",onChange:w}),!v&&r.createElement(ot.Z.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"Имя пользователя",value:d.username,name:"username",onChange:w}),r.createElement(fe.Z,{fluid:!0,size:"large",onClick:b},n))),(null==h?void 0:h.error)&&(null!=h&&h.error?r.createElement(at.Z,{negative:!0,content:r.createElement("p",null,null===(Z=h.error)||void 0===Z?void 0:Z.message)}):null),r.createElement(at.Z,null,a," ",r.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),g(),y({type:j})}},o))))},mt=n(89172),dt=n(76381),pt=n(92986),Et=function(e){var t=e.errorMessage;return r.createElement(mt.Z,null,r.createElement("div",{className:"mt20"},r.createElement(at.Z,{negative:!0},r.createElement(at.Z.Header,null,"Ошибка"),r.createElement("p",null,t))))},ft=n(17556),vt=function(){return r.createElement("div",{className:"loading-overlay"},r.createElement(ft.Z,{active:!0}))},gt=function(e){var t=e.isLoading,n=e.errorMessage,a=e.children,o=(0,l.v9)((function(e){return e})).user.isLoading;return t||o?r.createElement(vt,null):n?r.createElement(Et,{errorMessage:n}):a()},yt=function(){var e=(0,l.I0)(),t=(0,l.v9)((function(e){return e})).users,n=t.data,a=t.isLoading,o=t.error,c=(0,r.useState)(0),i=(0,Ce.Z)(c,2),u=i[0],s=i[1],m=(0,r.useState)(0),d=(0,Ce.Z)(m,2),p=d[0],E=d[1];return(0,r.useEffect)((function(){return e(tt({page:u})),function(){e({type:Y})}}),[u]),(0,r.useEffect)((function(){n&&E(Math.ceil(n.total/n.limit))}),[n]),r.createElement(gt,{isLoading:a,errorMessage:null==o?void 0:o.message},(function(){return r.createElement(mt.Z,{className:"users"},r.createElement(lt.Z,{as:"h2",size:"large"},"Пользователи"),r.createElement(dt.Z,{singleLine:!0},r.createElement(dt.Z.Header,null,r.createElement(dt.Z.Row,null,r.createElement(dt.Z.HeaderCell,null,"Пользователь"))),r.createElement(dt.Z.Body,null,null==n?void 0:n.items.map((function(e){return r.createElement(dt.Z.Row,{key:e._id},r.createElement(dt.Z.Cell,null,r.createElement(pe.rU,{to:"/profile/".concat(e._id),key:"profile"},e.username)))})))),r.createElement(pt.Z,{defaultActivePage:u+1,totalPages:p,onPageChange:function(e,t){s(Number(t.activePage)-1)}}))}))},ht=n(93669),Zt=n(74083),wt=function(e){var t=e.selectedYear,n=e.onSelect,a=function(e){for(var t=e?[{key:"total",value:0,text:"За всё время"}]:[],n=Ae;n>=2010;n--)t.push({key:n.toString(),value:n,text:n.toString()});return t}(e.showAllOption),l=a.find((function(e){return e.value===t}))||a[0];return r.createElement(Zt.Z,{inline:!0,options:a,value:l.value,onChange:n})},bt=n(88611),Ct=n.n(bt),Ot=function(e){var t,n=e.searchAction,a=e.onSuggestionSelected,o=e.titlePropName,c=e.releasePropName,i=e.placeholder,u=(0,l.I0)(),s=(0,l.v9)((function(e){return e.emptyRecordTMDbItems})),m=null===(t=(0,l.v9)((function(e){return e.user})).data)||void 0===t?void 0:t.userId,d=(0,r.useState)(""),p=(0,Ce.Z)(d,2),E=p[0],f=p[1],v={placeholder:i,value:E,onChange:function(e,t){if("type"===t.method){var r=e.target.value;f(r),r.length>2&&u(n(r))}},autoFocus:!0};return r.createElement(Ct(),{onSuggestionsFetchRequested:Q.noop,onSuggestionsClearRequested:Q.noop,onSuggestionSelected:function(e,t){var n=t.suggestion;f(n[o]),a(n,m)},suggestions:s,getSuggestionValue:function(e){return e[o]},renderSuggestion:function(e){var t,n=e[c]?"(".concat(null===(t=e[c])||void 0===t?void 0:t.substring(0,4),")"):"";return r.createElement("div",{className:"suggestion-item",id:e.id.toString()},e[o]+" "+n)},inputProps:v,multiSection:null})},St=n(96546),_t=n(2523),kt=n(42627),It=n(10448),Tt=function(e){var t=e.header,n=e.text,a=e.onClose,l=e.onNegative,o=e.onPositive;return r.createElement(It.Z,{size:"mini",open:!0,onClose:a},r.createElement(It.Z.Header,null,t),r.createElement(It.Z.Content,null,r.createElement("p",null,n)),r.createElement(It.Z.Actions,null,r.createElement(fe.Z,{negative:!0,onClick:l},"Нет"),r.createElement(fe.Z,{positive:!0,onClick:function(){o(),a()}},"Да")))},Nt=n(22648),Rt=n.n(Nt),xt=n(49593),Pt=function(e,t){var n=(0,r.useState)(e),a=(0,Ce.Z)(n,2),l=a[0],o=a[1];return[l,function(e){o(e),t(e)}]},At=function(e){return r.createElement("svg",(0,ge.Z)({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-x feather-icon"},e),r.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))},Dt=(n(1993),n(55957)),jt=function(e){var t,n=e._id,a=e.viewdate,o=e.posterpath,c=e.title,i=e.releaseYear,u=e.originalTitle,s=e.director,m=e.genres,d=e.rating,p=e.type,E=e.production_countries,f=e.season,v=e.position,g=e.isReadOnly,y=e.isPositionMode,h="0"===n,Z=p===q.MOVIE,w=!Z,_=(0,l.I0)(),k=rt(!1),I=(0,Ce.Z)(k,2),T=I[0],N=I[1],R=rt(!1),D=(0,Ce.Z)(R,2),j=D[0],L=D[1],U=rt(!1),M=(0,Ce.Z)(U,2),F=M[0],V=M[1],B=rt(!1),Y=(0,Ce.Z)(B,2),G=Y[0],H=Y[1],K=Pt(a,(function(e){return _($e(n,{viewdate:e}))})),z=(0,Ce.Z)(K,2),W=z[0],J=z[1],$=Pt(d,(function(e){return _($e(n,{rating:e}))})),Q=(0,Ce.Z)($,2),X=Q[0],ee=Q[1],te=Pt(f,(function(e){return _($e(n,{season:e}))})),ne=(0,Ce.Z)(te,2),re=ne[0],ae=ne[1],le=function(){return _({type:S})};return r.createElement(r.Fragment,null,r.createElement(ct.Z,{className:"record ".concat(Z?"blue-bg":"violet-bg"),id:n},r.createElement(ve.Z,{verticalAlign:"middle"},r.createElement(ve.Z.Column,{width:2,textAlign:"center",className:"column-viewdate"},function(){if(h)return null;if(!g&&j){var e=function(e){var t=e.value,n=e.onClick,a=e.onChange,l=e.onBlur;return r.createElement(ht.Z,{className:"datepicker-input",value:t,onClick:n,onChange:a,onBlur:l})};return r.createElement(Rt(),{dateFormat:"d MMMM",locale:xt.Z,selected:W,onChange:function(e){g||(J(e),L())},customInput:r.createElement(e),onBlur:L})}return r.createElement("span",{title:"Нажите дважды, чтобы изменить",onClick:L},(n=He[(t=a).getMonth()],l=String(t.getDate()).padStart(2,"0").replace(/^0+/,""),"".concat(l," ").concat(n)));var t,n,l}()),r.createElement(ve.Z.Column,{width:2,textAlign:"center"},h?null:r.createElement(St.Z,{src:"".concat(Re,"/").concat(o),size:"tiny"})),r.createElement(ve.Z.Column,{width:8,className:"column-title"},function(){if(h){var e=Z?{searchAction:(0,Dt.Z)(qe,300,{leading:!1}),onSuggestionSelected:function(e,t){return _(function(e,t){return function(){var n=(0,be.Z)(Se().mark((function n(r){var a,l,o,c,i,u;return Se().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:x}),n.prev=1,n.next=4,Promise.all([(s=e,ke().get("".concat(Te,"/movie/").concat(s,"?api_key=").concat(Ie,"&language=ru-RU"))),Ne(e)]);case 4:return a=n.sent,l=(0,Ce.Z)(a,2),o=l[0],c=l[1],i=ze(t,o.data,c.data),n.next=11,Le(i);case 11:u=n.sent,r({type:P,payload:u.data}),n.next=19;break;case 15:throw n.prev=15,n.t0=n.catch(1),r({type:A,payload:n.t0}),n.t0;case 19:case"end":return n.stop()}var s}),n,null,[[1,15]])})));return function(e){return n.apply(this,arguments)}}()}(e.id,t))},titlePropName:"title",releasePropName:"release_date",placeholder:"Найти фильм..."}:{searchAction:(0,Dt.Z)(Je,300,{leading:!1}),onSuggestionSelected:function(e,t){return _(function(e,t){return function(){var n=(0,be.Z)(Se().mark((function n(r){var a,l,o;return Se().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:x}),n.prev=1,n.next=4,c=e,ke().get("".concat(Te,"/tv/").concat(c,"?api_key=").concat(Ie,"&language=ru-RU"));case 4:return a=n.sent,l=We(t,a.data),n.next=8,Le(l);case 8:o=n.sent,r({type:P,payload:o.data}),n.next=16;break;case 12:throw n.prev=12,n.t0=n.catch(1),r({type:A,payload:n.t0}),n.t0;case 16:case"end":return n.stop()}var c}),n,null,[[1,12]])})));return function(e){return n.apply(this,arguments)}}()}(e.id,t))},titlePropName:"name",releasePropName:"first_air_date",placeholder:"Найти сериал..."};return r.createElement(Ot,e)}return r.createElement(r.Fragment,null,r.createElement("div",{className:"title"},"".concat(c," (").concat(i,")"),w?!g&&G?r.createElement(ht.Z,{className:"edit-mode-season-info",value:re,autoFocus:!0,onChange:function(e){return ae(e.target.value)},onFocus:function(e){return e.currentTarget.select()},onBlur:H,size:"mini"}):r.createElement("span",{onClick:H},", "+f+" сезон"):null),r.createElement("div",{className:"additional-info"},r.createElement("span",null,u," ",r.createElement("span",{className:"director"},"".concat(Z?"реж.":"создатели")," ",s.join(", ")))),r.createElement("div",{className:"genre"},m.map((function(e){return e.name})).join(", ")))}()),r.createElement(ve.Z.Column,{width:2,textAlign:"center"},h?null:E.map((function(e){return r.createElement(_t.Z,{key:e,name:e})}))),r.createElement(ve.Z.Column,{width:2,textAlign:"center"},!g&&F?r.createElement(ht.Z,{className:"edit-mode-rating",value:X,autoFocus:!0,onChange:function(e){var t=+e.target.value;if(isNaN(t)||t<1||t>10)return null;g||ee(t)},onFocus:function(e){return e.currentTarget.select()},onBlur:V}):r.createElement("span",{title:"Нажите, чтобы изменить",className:"rating ".concat(0===d?"red":""),onClick:V},d))),!g&&((t=[]).push(r.createElement(At,{key:"icon",title:"удалить запись",onClick:h?le:N})),r.createElement("span",{className:"icons-panel"},t)),y&&r.createElement(kt.Z,{circular:!0,className:"position",color:"orange"},v)),T&&r.createElement(Tt,{header:"Удаление записи",text:"Вы уверены, что хотите удалить запись?",onClose:N,onNegative:N,onPositive:function(){return _((e=n,function(){var t=(0,be.Z)(Se().mark((function t(n){return Se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:b}),t.prev=1,t.next=4,Fe(e);case 4:n({type:C,payload:e}),t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(1),n({type:O,payload:t.t0}),t.t0;case 11:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}()));var e}}))};function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mt(e,t){return parseInt(e.position)<parseInt(t.position)?-1:parseInt(e.position)>parseInt(t.position)?1:0}var Ft=function(e,t){var n=t?q.MOVIE:q.TV_SERIES;return e.filter((function(e){return e.type===n}))},Vt=function(e){var t=e.match,n=(0,l.I0)(),a=t.params.id,o=(0,l.v9)((function(e){return e})),c=o.records,i=c.data,u=c.isLoading,p=c.error,E=o.user.data,f=(0,r.useState)(!0),g=(0,Ce.Z)(f,2),y=g[0],h=g[1],Z=(0,r.useState)(null),w=(0,Ce.Z)(Z,2),b=w[0],C=w[1],O=(0,r.useState)(!1),S=(0,Ce.Z)(O,2),_=S[0],k=S[1],I=(0,r.useState)(Ae),T=(0,Ce.Z)(I,2),N=T[0],R=T[1],x=(0,Q.isEmpty)(b),P=!x&&(null==i?void 0:i.some((function(e){return e.position&&e.type===(y?q.MOVIE:q.TV_SERIES)})));(0,r.useEffect)((function(){var e=Ut(Ut({},De),{},{year:N});return n(Qe(a,e)),function(){n({type:v})}}),[n,a,N]),(0,r.useEffect)((function(){C(i)}),[i]);var A=function(e){var t=e.currentTarget.closest("tr").dataset.id,n=b.find((function(e){return e._id===t}));n.isSelected=!n.isSelected;var r=b.map((function(e){return e._id===t?n:e}));C(r)},D=function(e){e.preventDefault();for(var t=[],r=e.currentTarget.closest(".results").getElementsByClassName("position"),a={},l=0;l<r.length;l++){var o=r[l].getElementsByTagName("input")[0].value,c=r[l];a[c.dataset.id]=o}Ft(i,y).forEach((function(e){var n=e._id;e.position!==a[n]&&t.push({_id:n,position:a[n],viewdate:new Date((new Date).setFullYear(N)),userId:E.userId})})),_&&k(!1),n(function(e){return function(){var t=(0,be.Z)(Se().mark((function t(n){var r;return Se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:s}),t.prev=1,t.next=4,Me(e);case 4:return r=t.sent,n({type:m,payload:r.data}),t.abrupt("return",r);case 9:throw t.prev=9,t.t0=t.catch(1),n({type:d,payload:t.t0}),t.t0;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}(t))},j=function(){k(!0)};return r.createElement(gt,{isLoading:u,errorMessage:null==p?void 0:p.message},(function(){return r.createElement(mt.Z,{className:"results"},r.createElement(lt.Z,{as:"h2",size:"large"},"Итоги"),r.createElement(wt,{selectedYear:N,onSelect:function(e,t){return R(t.value)}}),"   ",r.createElement("span",{className:"record-filter ".concat(y?"":"not-selected"),onClick:function(){return h(!0)},title:"Показать фильмы"},"Фильмы"),"   ",r.createElement("span",{className:"record-filter ".concat(y?"not-selected":""),onClick:function(){return h(!1)},title:"Показать сериалы"},"Сериалы"),"   ",P&&!_?r.createElement(r.Fragment,null,Ft(i,y).filter((function(e){return parseInt(e.position)})).sort(Mt).map((function(e){return r.createElement(jt,(0,ge.Z)({isReadOnly:!0,isPositionMode:!0,key:e._id},e))})),r.createElement("a",{href:"#",onClick:j},"Редактировать")):x?r.createElement(r.Fragment,null,r.createElement(at.Z,{info:!0},r.createElement("p",null,"В вашем журнале нет ни одной записи за текущий год.")),r.createElement(pe.rU,{to:"/diary/".concat(E.userId),key:"diary"},"Перейти к журналу")):r.createElement(r.Fragment,null,r.createElement(at.Z,{info:!0},r.createElement("p",null,'Расcтавьте позиции в таблице ниже и нажмите кнопку "Сохранить"')),!(0,Q.isEmpty)(b)&&r.createElement(dt.Z,{className:"results-table",celled:!0},r.createElement(dt.Z.Header,null,r.createElement(dt.Z.Row,null,r.createElement(dt.Z.HeaderCell,null,"Позиция"),r.createElement(dt.Z.HeaderCell,null,"Наименование"),r.createElement(dt.Z.HeaderCell,null,"Оценка"))),r.createElement(dt.Z.Body,null,Ft(b,y).map((function(e){return r.createElement(dt.Z.Row,{"data-id":e._id,key:e._id,onClick:A,className:"".concat(e.isSelected?"selected":"")},r.createElement(dt.Z.Cell,{collapsing:!0},r.createElement(ht.Z,{"data-id":e._id,className:"position",maxLength:"2",onClick:function(e){return e.stopPropagation()},onChange:function(t){k(!0);var n=(0,te.Z)(b),r=n.findIndex((function(t){return t._id===e._id})),a=Ut(Ut({},n.find((function(t){return t._id===e._id}))),{},{position:t.target.value});n[r]=a,C(n)},value:e.position})),r.createElement(dt.Z.Cell,null,e.title),r.createElement(dt.Z.Cell,{className:0===e.rating?"red":""},e.rating))})))),r.createElement("a",{href:"#",onClick:D},"Сохранить")))}))};function Bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bt(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Gt=function(e){var t=e.match,n=(0,l.I0)(),a=t.params.id,o=(0,l.v9)((function(e){return e})),c=o.records,i=c.data,u=c.error,s=o.user.data,m=a!==(null==s?void 0:s.userId),d=(0,r.useState)(!0),p=(0,Ce.Z)(d,2),E=p[0],f=p[1],h=(0,r.useState)(!0),Z=(0,Ce.Z)(h,2),w=Z[0],b=Z[1],C=(0,r.useState)(De),O=(0,Ce.Z)(C,2),S=O[0],_=O[1],k=(0,Q.some)(i,(function(e){return e.isEmptyRecord})),I=(0,Q.filter)(i,(function(e){var t=e.type;return!e.isEmptyRecord&&t===q.MOVIE})).length,T=(0,Q.filter)(i,(function(e){var t=e.type;return!e.isEmptyRecord&&t===q.TV_SERIES})).length;(0,r.useEffect)((function(){return n(Qe(a,S)),function(){n({type:v})}}),[n,a,S]);var N=(0,Q.filter)(i,(function(e){return!(!E||e.type!==q.MOVIE)||!(!w||e.type!==q.TV_SERIES)}));return r.createElement(gt,{isLoading:(0,Q.isNull)(i),errorMessage:null==u?void 0:u.message},(function(){return r.createElement(mt.Z,{className:"diary"},r.createElement(lt.Z,{as:"h2",size:"large"},"Журнал пользователя"),r.createElement(ve.Z,{columns:"2",verticalAlign:"middle"},r.createElement(ve.Z.Column,null,r.createElement(wt,{selectedYear:S.year,onSelect:function(e,t){return _(Yt(Yt({},S),{},{year:Number(t.value)}))}}),"   ",r.createElement("span",{className:"record-filter ".concat(E?"":"not-selected"),onClick:function(){return f(!E)},title:E?"Скрыть фильмы":"Показать фильмы"},"Фильмы (",I,")"),"   ",r.createElement("span",{className:"record-filter ".concat(w?"":"not-selected"),onClick:function(){return b(!w)},title:w?"Скрыть сериалы":"Показать сериалы"},"Сериалы (",T,")"),"   "),r.createElement(ve.Z.Column,{textAlign:"right"},!m&&r.createElement(r.Fragment,null,r.createElement("span",null,"Добавить"),"   ",r.createElement(fe.Z,{disabled:k,onClick:function(){return n({type:g})}},"Фильм"),r.createElement(fe.Z,{disabled:k,onClick:function(){return n({type:y})}},"Сериал")))),N.map((function(e){return r.createElement(jt,(0,ge.Z)({key:e._id},e,{isReadOnly:m}))})),0===N.length&&r.createElement(at.Z,{info:!0},r.createElement(at.Z.Header,null,"В вашем журнале пока нет ни одной записи для выбранного года"),r.createElement("p",null,"Добавьте запись о просмотренном фильме или сериале")))}))},Ht=n(52607),Kt=n(9911),zt=n(5609),Wt=n(5015),qt=n(38724),Jt=n(32529),$t=n(26299),Qt=n(52734),Xt=n(25180),en=n(58640),tn=n(38638),nn=n(55936),rn=n(64420);function an(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,rn.Z)(e);if(t){var a=(0,rn.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,nn.Z)(this,n)}}var ln=function(e){(0,tn.Z)(n,e);var t=an(n);function n(){return(0,Xt.Z)(this,n),t.apply(this,arguments)}return(0,en.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.x,n=e.y,a=e.payload;return r.createElement("g",{transform:"translate(".concat(t,",").concat(n,")")},r.createElement("text",{x:30,y:-11,dy:16,className:"small",textAnchor:"end",fill:"#666",transform:"rotate(90)"},a.value))}}]),n}(r.PureComponent),on=function(e){var t=e.onClick;return r.createElement("div",{className:"card empty-card",onClick:t},r.createElement("svg",{className:"plus",width:"54",height:"54",viewBox:"0 0 54 54",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M27 11.25V42.75",stroke:"#DFDFE4",strokeWidth:"4.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M11.25 27H42.75",stroke:"#DFDFE4",strokeWidth:"4.5",strokeLinecap:"round",strokeLinejoin:"round"})))},cn=function(e){var t=e.header,n=e.content,a=e.onClose,l=e.onSuccess,o=e.successText,c=e.successDisabled,i=e.hideCancel;return r.createElement(It.Z,{onClose:a,open:!0,closeOnDimmerClick:!1},r.createElement(It.Z.Header,null,t),r.createElement(It.Z.Content,null,n),r.createElement(It.Z.Actions,null,!i&&r.createElement(fe.Z,{onClick:a},"Отмена"),r.createElement(fe.Z,{onClick:l,disabled:c,positive:!0},o||"Ок")))},un=function(e){var t=e.onClose,n=e.index,a=(0,r.useState)(null),o=(0,Ce.Z)(a,2),c=o[0],i=o[1],u=(0,l.v9)((function(e){return e})).users.data,s=u?u.items[0]:null,m=(0,l.I0)(),d=r.createElement(r.Fragment,null,r.createElement("div",{className:"falvourite-movie-search"},r.createElement(Ot,{searchAction:(0,Dt.Z)(qe,300,{leading:!1}),onSuggestionSelected:function(e){return i(e)},titlePropName:"title",releasePropName:"release_date",placeholder:"Найти фильм..."})),c&&r.createElement("div",{className:"movie-info"},r.createElement(St.Z,{src:"".concat(Re,"/").concat(c.poster_path),size:"tiny"}),r.createElement("div",{className:"title"},"".concat(c.title," (").concat(new Date(c.release_date).getFullYear(),")"))));return r.createElement(cn,{content:d,header:"Выберите фильм",onClose:t,onSuccess:function(){var e={id:c.id,title:c.title,poster_path:c.poster_path,release_date:c.release_date,position:n},r=(0,te.Z)(null==s?void 0:s.favouriteMovies);r.push(e),m(nt({favouriteMovies:r})),t()},successText:"Добавить",successDisabled:!c})},sn=n(85018),mn=function(e){var t,n=e.movie,a=e.index,l=e.onRemove,o=e.disabled,c=(0,r.useState)(!1),i=(0,Ce.Z)(c,2),u=i[0],s=i[1],m=rt(!1),d=(0,Ce.Z)(m,2),p=d[0],E=d[1];return t=n?r.createElement("div",{className:"favourite-movie-poster"},r.createElement(sn.Z,{name:"remove circle",onClick:E,title:"удалить",className:"remove-icon"}),r.createElement(St.Z,{onError:function(e){e.target.onerror=null,e.target.src="../src/Assets/empty.png"},src:"".concat(Re,"/").concat(n.poster_path),title:"".concat(n.title," (").concat(new Date(n.release_date).getFullYear(),")")})):r.createElement(on,{onClick:function(){o||s(!0)}}),r.createElement(r.Fragment,null,t,u&&r.createElement(un,{onClose:function(){return s(!1)},index:a}),p&&r.createElement(Tt,{header:"Удаление записи",text:"Вы уверены, что хотите удалить запись?",onClose:E,onNegative:E,onPositive:l}))},dn=function(e){var t=e.active,n=e.payload,a=e.label;return t?r.createElement("div",{className:"custom-tooltip"},r.createElement("p",{className:"label"},"Фильмов в жанре ".concat(a,": ").concat(n[0].value))):null},pn=function(e){var t=e.active,n=e.payload,a=e.label;return t?r.createElement("div",{className:"custom-tooltip"},r.createElement("p",{className:"label"},"Фильмов производства ".concat(a,": ").concat(n[0].value))):null},En=function(e){var t=e.match,n=(0,l.I0)(),a=t.params.id,o=(0,l.v9)((function(e){return e})),c=o.users,i=c.data,s=c.isLoading,m=c.error,d=o.stat,v=d.data,g=d.isLoading,y=d.error,h=o.user.data,Z=i?i.items[0]:null,w=(null==v?void 0:v.marksData)||[],b=(0,r.useState)(0),C=(0,Ce.Z)(b,2),O=C[0],S=C[1],_=(0,r.useState)(""),k=(0,Ce.Z)(_,2),I=k[0],T=k[1];(0,r.useEffect)((function(){return n(tt({userId:a})),function(){n({type:Y})}}),[]),(0,r.useEffect)((function(){n(function(e,t){return function(){var n=(0,be.Z)(Se().mark((function n(r){var a;return Se().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:p}),n.prev=1,n.next=4,Be(e,t);case 4:return a=n.sent,r({type:E,payload:a}),n.abrupt("return",a);case 9:throw n.prev=9,n.t0=n.catch(1),r({type:f,payload:n.t0}),n.t0;case 13:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e){return n.apply(this,arguments)}}()}(a,O))}),[O]);var N,R=[],x=(0,Q.map)(null==Z?void 0:Z.favouriteMovies,(function(e){return(0,u.Z)({},e.position,e)}));x&&(N=Object.assign.apply(Object,[{}].concat((0,te.Z)(x))));for(var P=function(e){var t;R.push(r.createElement(mn,{movie:null===(t=N)||void 0===t?void 0:t[e],index:e,onRemove:function(){var t=null==Z?void 0:Z.favouriteMovies.filter((function(t){return t.position!==e}));n(nt({favouriteMovies:t}))},disabled:a!==(null==h?void 0:h.userId)}))},A=0;A<10;A++)P(A);var D=function(){var e=(0,be.Z)(Se().mark((function e(t){var n,r,a,l,o;return Se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.files[0],(r=new FormData).append("image",n),e.prev=3,a={headers:{"Content-Type":"multipart/form-data"}},e.next=7,ke().post("/api/upload",r,a);case 7:l=e.sent,o=l.data,T(o),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}();return r.createElement(gt,{isLoading:s||g,errorMessage:(null==m?void 0:m.message)||(null==y?void 0:y.message)},(function(){return r.createElement(mt.Z,{className:"profile"},r.createElement(lt.Z,{as:"h2",size:"large"},"Профиль пользователя"),r.createElement(ct.Z,null,r.createElement(ve.Z,{className:"profile-data"},r.createElement(ve.Z.Column,{width:4},r.createElement(St.Z,{className:"profile-data-image",src:"/uploads/".concat(I),circular:!0}),r.createElement(fe.Z,{as:"label",htmlFor:"file",type:"button",animated:"fade"},r.createElement(fe.Z.Content,{visible:!0},"File"),r.createElement(fe.Z.Content,{hidden:!0},"Choose a File")),r.createElement("input",{type:"file",id:"file",hidden:!0,onChange:D}),r.createElement("div",{className:"title"},"".concat(null==Z?void 0:Z.username)),r.createElement("div",{className:"additional"},"Russia, Tver"),r.createElement("div",{className:"label"},"В этом году"),r.createElement("div",{className:"counter"},r.createElement("div",{className:"total"},(null==v?void 0:v.recordsCurrentYearCount.movies)+(null==v?void 0:v.recordsCurrentYearCount.tvseries)),r.createElement("div",{className:"divided"},r.createElement("div",null,null==v?void 0:v.recordsCurrentYearCount.movies," фильмов"),r.createElement("div",null,null==v?void 0:v.recordsCurrentYearCount.tvseries," сериалов"))),r.createElement("div",{className:"label"},"За всё время"),r.createElement("div",{className:"counter"},r.createElement("div",{className:"total"},(null==v?void 0:v.recordsTotalCount.movies)+(null==v?void 0:v.recordsTotalCount.tvseries)),r.createElement("div",{className:"divided"},r.createElement("div",null,null==v?void 0:v.recordsTotalCount.movies," фильмов"),r.createElement("div",null,null==v?void 0:v.recordsTotalCount.tvseries," сериалов"))),r.createElement("div",{className:"label"},r.createElement(pe.rU,{to:"/diary/".concat(a)},"Смотреть журнал")),r.createElement("div",{className:"label"},r.createElement(pe.rU,{to:"/results/".concat(a)},"Смотреть итоги"))),r.createElement(ve.Z.Column,{width:12},r.createElement("div",null,"Любимые фильмы"),r.createElement("div",{className:"grid-panel"},R)))),r.createElement(ve.Z,null,r.createElement(ve.Z.Row,null,r.createElement(ve.Z.Column,{width:4}),r.createElement(ve.Z.Column,{width:8,textAlign:"center"},r.createElement("h1",null,r.createElement(wt,{showAllOption:!0,selectedYear:O,onSelect:function(e,t){return S(Number(t.value))}})),r.createElement("h3",null,"".concat(w.reduce((function(e,t){return e+t.markCount}),0))," ","оценок"),r.createElement(Kt.h,{width:"100%",height:200},r.createElement(zt.v,{margin:{top:30},data:w},r.createElement(Wt.$,{dataKey:"markCount",fill:"#5CE0E6"},r.createElement(qt.e,{dataKey:"markCount",position:"top"})),r.createElement(Jt.K,{dataKey:"mark"})))),r.createElement(ve.Z.Column,{width:4})),r.createElement(ve.Z.Row,null,r.createElement(ve.Z.Column,{width:8},r.createElement("h3",null,"Жанры"),r.createElement(Kt.h,{width:"100%",height:300},r.createElement(zt.v,{width:600,height:300,data:null==v?void 0:v.genresData,layout:"vertical",margin:{top:5,bottom:5}},r.createElement(Jt.K,{type:"number"}),r.createElement($t.B,{type:"category",dataKey:"name",interval:0,width:150}),r.createElement(Qt.u,{content:function(e){var t=e.active,n=e.payload,a=e.label;return r.createElement(dn,{active:t,payload:n,label:a})}}),r.createElement(Wt.$,{dataKey:"value",fill:"#19C2FA"})))),r.createElement(ve.Z.Column,{width:8,textAlign:"center"},r.createElement("h3",null,"Страны"),r.createElement(Kt.h,{width:"100%",height:300},r.createElement(zt.v,{width:600,height:300,data:null==v?void 0:v.countriesData,layout:"vertical",margin:{top:5,bottom:5}},r.createElement(Jt.K,{type:"number"}),r.createElement($t.B,{type:"category",dataKey:"countryName",interval:0,width:150}),r.createElement(Qt.u,{content:function(e){var t=e.active,n=e.payload,a=e.label;return r.createElement(pn,{active:t,payload:n,label:a})}}),r.createElement(Wt.$,{dataKey:"countryCount",fill:"#FA1955"}))))),r.createElement(ve.Z.Row,{columns:3},r.createElement(ve.Z.Column,null,r.createElement("h3",null,"Режиссёры"),r.createElement(Ht.Z,{ordered:!0},null==v?void 0:v.directorsData.map((function(e){return r.createElement(Ht.Z.Item,{key:"".concat(e.director).concat(e.directorCount)},"".concat(e.director," (").concat(e.directorCount,")"))})))),r.createElement(ve.Z.Column,null,r.createElement("h3",null,"Актёры"),r.createElement(Ht.Z,{ordered:!0},null==v?void 0:v.actorsData.map((function(e,t){return r.createElement(Ht.Z.Item,{key:t},"".concat(e.actor," (").concat(e.actorCount,")"))})))),r.createElement(ve.Z.Column,null,r.createElement("h3",null,"Актрисы"),r.createElement(Ht.Z,{ordered:!0},null==v?void 0:v.actressesData.map((function(e,t){return r.createElement(Ht.Z.Item,{key:t},"".concat(e.actress," (").concat(e.actressCount,")"))}))))),r.createElement(ve.Z.Row,null,r.createElement(ve.Z.Column,null,r.createElement("h3",null,"Год выпуска"),r.createElement(Kt.h,{width:"100%",height:200},r.createElement(zt.v,{margin:{top:30},data:null==v?void 0:v.yearsData},r.createElement(Wt.$,{dataKey:"yearCount",fill:"#5CE0E6"},r.createElement(qt.e,{dataKey:"yearCount",position:"top"})),r.createElement(Jt.K,{dataKey:"year",interval:0,height:100,tick:function(e){var t=e.x,n=e.y,a=e.payload;return r.createElement(ln,{x:t,y:n,payload:a})}})))))))}))},fn=function(){return r.createElement("div",{className:"about"},r.createElement(mt.Z,{className:"about"},r.createElement("h1",{className:"mt20"},"О проекте"),r.createElement("p",null,"Tracked - это веб-приложение для ведения учёта просмотренных фильмов и сериалов, а также создания ежегодного итогового рейтинга лучших просмотренных фильмов и сериалов за год."),r.createElement("p",null,"Tracked вдохновлён такими проектами, как"," ",r.createElement("a",{href:"https://letterboxd.com/",target:"_blank",rel:"noreferrer"},"Letterboxd")," ","и"," ",r.createElement("a",{href:"https://www.kinopoisk.ru/",target:"_blank",rel:"noreferrer"},"КиноПоиск"),"."),r.createElement("br",null),r.createElement("p",null,"Уже сейчас Tracked позволяет пользователям:"),r.createElement(Ht.Z,null,r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Добавлять записи о просмотренных фильмах и сериалах в журнал просмотров с привязкой к дате просмотра")),r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Ставить оценки просмотренным фильмам")),r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Просматривать статистику в разных аспектах, созданную автоматически на основе внесённых данных")),r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Подводить итоги года и создавать списки лучших просмотренных фильмов и сериалов за год"))),r.createElement("br",null),r.createElement("p",null,"Сервис планируется развивать в таких направлениях, как:"),r.createElement(Ht.Z,null,r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Статистика")),r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Алгоритмы рекомендаций")),r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Геймификация")),r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Социальные сети"))),r.createElement("br",null),r.createElement("p",null,"В будущем планируется добавить:"),r.createElement(Ht.Z,null,r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Возможность добавления записей в список желаемого")),r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Систему рекомендаций фильмов/сериалов на основе оригинального алгоритмай")),r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Возможность подписки на пользователей, возможность просмотра новостной ленты (кто что посмотрел, кто что добавил в список желаемого и т.д.)")),r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Элементы геймификации - бейджи и др.")),r.createElement(Ht.Z.Item,null,r.createElement(Ht.Z.Icon,{name:"angle right"}),r.createElement(Ht.Z.Content,null,"Возможность внесения не только просмотренных фильмов и сериалов, но и компьютерных игр, в которые удалось поиграть, а также книг, которые удалось прочитать"))),r.createElement("br",null),r.createElement("hr",null),r.createElement("br",null),r.createElement("p",null,"Если у вас есть желание поучаствовать в проекте, то пишите в телеграм @alexander_volkov. Также вы можете задать вопрос или сообщить о проблеме"," ",r.createElement("a",{href:"https://github.com/codyfet/tracked/issues",target:"_blank",rel:"noreferrer"},"здесь"),".")))},vn=n(83721),gn=["component","path","isAuthenticated"],yn=function(e){var t=e.component,n=e.path,a=e.isAuthenticated,l=(0,vn.Z)(e,gn);return r.createElement(Ee.AW,(0,ge.Z)({path:n},l,{render:function(e){return a?r.createElement(t,e):r.createElement(Ee.l_,{to:{pathname:"/login",state:{prevLocation:location.pathname,errorMessage:"Войдите или зарегистрируйтесь"}}})}}))},hn=function(){var e,t=(0,l.I0)(),n=JSON.parse(localStorage.getItem(xe)),r=!1;return n&&n.token&&(r=!0,t((e=n.userId,function(){var t=(0,be.Z)(Se().mark((function t(n){var r,a,l,o,c,i;return Se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:L}),t.prev=1,t.next=4,je(e);case 4:return r=t.sent,n({type:U,payload:r.data}),t.abrupt("return",r);case 9:t.prev=9,t.t0=t.catch(1),o=t.t0.response,c=null!==(a=null==o?void 0:o.data.message)&&void 0!==a?a:t.t0.message,i=null!==(l=null==o?void 0:o.status)&&void 0!==l?l:t.t0.status,n({type:M,payload:{message:c,status:i}});case 16:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()))),r},Zn=function(){var e,t=hn(),n=null===(e=(0,Ee.TH)().state)||void 0===e?void 0:e.errorMessage;return r.createElement(r.Fragment,null,n&&r.createElement(Et,{errorMessage:n}),r.createElement(Ee.rs,null,r.createElement(Ee.AW,{path:"/",exact:!0,component:we}),r.createElement(Ee.AW,{path:"/login",component:st}),r.createElement(Ee.AW,{path:"/about",component:fn}),r.createElement(yn,{path:"/users",isAuthenticated:t,component:yt}),r.createElement(yn,{path:"/results/:id",isAuthenticated:t,component:Vt}),r.createElement(yn,{path:"/diary/:id",isAuthenticated:t,component:Gt}),r.createElement(yn,{path:"/profile/:id",isAuthenticated:t,component:En})))},wn=function(){var e=(0,r.useState)(!1),t=(0,Ce.Z)(e,2),n=t[0],a=t[1],o=(0,l.v9)((function(e){return e})).user,c=(0,l.I0)(),i=(0,Ee.k6)(),u=!!o.data,s=function(){var e=(0,be.Z)(Se().mark((function e(){return Se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c((localStorage.removeItem(xe),{type:j}));case 2:i.push("/");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.createElement("div",{className:"header-app"},r.createElement("span",{className:"logo"},r.createElement(pe.rU,{to:"/",key:"main"},r.createElement("span",null,"tracked"))),u?r.createElement(r.Fragment,null,r.createElement("span",{className:"menu ".concat(n?"responsive":"")},r.createElement(pe.rU,{to:"/diary/".concat(o.data.userId),key:"diary"},"журнал просмотров"),r.createElement(pe.rU,{to:"/results/".concat(o.data.userId),key:"results"},"итоги"),r.createElement(pe.rU,{to:"/users",key:"users"},"пользователи"),r.createElement(pe.rU,{to:"/profile/".concat(o.data.userId),key:"profile"},"".concat(o.data.username)),r.createElement("a",{onClick:s},"выйти")),r.createElement(sn.Z,{name:"bars",onClick:function(){return a(!n)},title:"меню",className:"burger"})):r.createElement("span",{className:"menu"},r.createElement(pe.rU,{to:"/login",key:"login"},"войти")))},bn=function(){return r.createElement("div",{className:"footer"},r.createElement("div",{className:"footer-links"},r.createElement("div",null,r.createElement("a",{href:"/about"},"о проекте")),r.createElement("div",null,r.createElement("a",{href:"https://github.com/codyfet/tracked",target:"_blank",rel:"noreferrer"},"cсылка на github"))),r.createElement("div",{className:"copyright"},"tracked🎥2021"))},Cn=function(){return r.createElement(pe.VK,null,r.createElement(wn,null),r.createElement(Zn,null),r.createElement(bn,null))},On=(0,o.MT)(de,(0,c.Uo)((0,o.md)(i.Z)));a.render(r.createElement(l.zt,{store:On},r.createElement(Cn,null)),document.getElementById("app"))},55319:function(){}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var l=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(l.exports,l,l.exports,r),l.loaded=!0,l.exports}r.m=t,e=[],r.O=function(t,n,a,l){if(!n){var o=1/0;for(s=0;s<e.length;s++){n=e[s][0],a=e[s][1],l=e[s][2];for(var c=!0,i=0;i<n.length;i++)(!1&l||o>=l)&&Object.keys(r.O).every((function(e){return r.O[e](n[i])}))?n.splice(i--,1):(c=!1,l<o&&(o=l));if(c){e.splice(s--,1);var u=a();void 0!==u&&(t=u)}}return t}l=l||0;for(var s=e.length;s>0&&e[s-1][2]>l;s--)e[s]=e[s-1];e[s]=[n,a,l]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={179:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,l,o=n[0],c=n[1],i=n[2],u=0;for(a in c)r.o(c,a)&&(r.m[a]=c[a]);if(i)var s=i(r);for(t&&t(n);u<o.length;u++)l=o[u],r.o(e,l)&&e[l]&&e[l][0](),e[o[u]]=0;return r.O(s)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),r.O(void 0,[429],(function(){return r(71202)}));var a=r.O(void 0,[429],(function(){return r(34930)}));a=r.O(a)}();